from typing import Optional

from Downloaders import IDownloader
from Parsers import IParser

class Source():
    def __init__(
        self,
        title: str,
        description: str,
        cooldown: int,
        
        downloader: IDownloader,
        payload: dict,
        cookies: dict,
        
        parser: IParser,
        fields: dict,
        root: str
    ) -> None:
        self.title = title
        self._description = description
        self._cooldown = cooldown

        self._downloader = downloader
        self._payload = payload
        self._cookies = cookies

        self._parser = parser
        self._root = root
        self._fields = fields

    def download(
        self
    ) -> Optional[str]:
        content = self._downloader.download(
            payload=self._payload,
            cookies=self._cookies
        )
        return content

    def parse(
        self,
        content: str
    ) -> Optional[dict]:
        parsed = self._parser.parse(
            root=self._root,
            content=content,
            fields=self._fields
        )
        return parsed