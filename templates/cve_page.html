{% extends 'base.html' %}

{% block main %}

<table>
    <thead>
    <tr>
        <th>Priority</th>
        <th>Description</th>
        <th>Source</th>
    </tr>
    </thead>
    {% for description in descriptions %}
    <tr>
        <td>{{description['priority']}}</td>
        <td>{{description['value']}}</td>
        <td>{{description['source']}}</td>
    </tr>
    {% endfor %}
</table>

<table>
    <thead>
    <tr>
        <th>CVSS</th>
    </tr>
    </thead>
    <tr>
        {% if cve_info['cvss'] %}   
            <td>{{cve_info['cvss']}}</td>
        {% else %}
            <td>—</td>
        {% endif %}
    </tr>
</table>

<table>
    <thead>
    <tr>
        <th>Belonging</th>
    </tr>
    </thead>
    <tr>
        <td>{{cve_info['belonging']}}</td>
    </tr>
</table>

<table>
    <thead>
    <tr>
        <th>CWE</th>
    </tr>
    </thead>
    <tr>
        {% if cve_info['cwe_id'] %}   
            <td>
                <a href="/cwe/{{cve_info['cwe_id']}}">CWE-{{cve_info['cwe_id']}}</a>
            </td>
        {% else %}
            <td>—</td>
        {% endif %}
    </tr>
</table>

<table>
    <thead>
    <tr>
        <th>Published Date</th>
    </tr>
    </thead>
    <tr>
        <td>{{cve_info['published_date']}}</td>
    </tr>
</table>

{% if links %}
<table>
    <thead>
    <tr>
        <th>Links</th>
    </tr>
    </thead>
    {% for link in links%}
    <tr>
        <td>
            <a href="{{link['uri']}}">
                {{link['uri']}}
            </a>
        </td>
    </tr>
    
    {% endfor %}
</table>
{% endif %}

{% if techniques %}
<table>
    <thead>
    <tr>
        <th>MITRE Techniques</th>
    </tr>
    </thead>
    {% for technique in techniques %}
    <tr>
        <td>
            <a href="/techniques/{{technique['technique_id']}}">
                {{technique['name']}} ({{technique['technique_id']}})
            </a> 
            <button class="searchQuerySubmit" type="submit">X</button>
        </td>
    </tr>
    
    {% endfor %}
</table>
{% endif %}

<div class="searchBar">
    <form>
        <input class="searchQueryInput" name="technique" type="text" placeholder="Write here technique (format T0000) for CVE..." value="" required>
        <button class="searchQuerySubmit" type="submit">Add Technique</button>
    </form>
</div>

{% endblock %}